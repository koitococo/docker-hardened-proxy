listeners:
  tcp:
    address: "127.0.0.1:2375"
  unix:
    path: "/var/run/docker-proxy.sock"
    mode: 0660

upstream:
  # unix:///path/to/docker.sock or tcp://host:port
  url: "unix:///var/run/docker.sock"
  # Optional TLS config for tcp:// upstream (when daemon uses HTTPS)
  # tls:
  #   ca: "/path/to/ca.pem"
  #   cert: "/path/to/cert.pem"
  #   key: "/path/to/key.pem"

namespace: "default"

audit:
  deny_privileged: true
  deny_security_opt_override: true
  deny_devices: true
  deny_info: true
  deny_oom_kill_disable: true
  deny_pids_limit_override: true
  deny_log_config_override: true
  denied_capabilities:
    - "ALL"
    - "SYS_ADMIN"
    - "NET_ADMIN"
  sysctls:
    # "deny" (default): only allow sysctls in the allowed list
    # "allow": allow all sysctls
    default_action: "deny"
    # allowed:
    #   - "net.ipv4.ping_group_range"
  bind_mounts:
    default_action: "deny"
    rules:
      - source_prefix: "/home/ubuntu"
        rewrite_prefix: "/path/to/container/home/ubuntu"
        action: "allow"
  namespaces:
    network_mode:
      deny_host: true
    ipc_mode:
      deny_host: true
    pid_mode:
      deny_host: true
    uts_mode:
      deny_host: true
  build:
    # "deny" (default): block all builds
    # "allow": allow all builds (with security enforcement)
    # "list": allow builds only for listed image names
    policy: "deny"
    # For "list" policy: allowed image name patterns.
    # Entries ending with "/" act as prefix matches (e.g., "registry.example.com/").
    # Other entries match the exact image name (with or without tag).
    # allowed:
    #   - "myapp"
    #   - "registry.example.com/"
    #
    # Security enforcement (always active when builds are allowed):
    #   - Dangerous entitlements (network.host, security.insecure) are stripped
    #   - networkmode=host is denied
    #   - /session endpoint is denied (blocks secrets and SSH agent forwarding)
  pull:
    # "allow" (default): allow all image pulls
    # "deny": block all image pulls
    # "list": allow pulls only for listed images/registries
    policy: "allow"
    # For "list" policy: allowed image name patterns (same syntax as build.allowed).
    # allowed:
    #   - "alpine"
    #   - "docker.io/library/"

logging:
  level: "info"
  format: "json"
